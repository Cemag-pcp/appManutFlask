{% extends "user/layout.html" %}
{% block body %}

  <div class="col-md-4 offset-md-4">
    {% with messages = get_flashed_messages()  %}
    {% if messages %}
    {% for message in messages %}
    <div class="alert alert-success alert-dismissible fade show" role="alert">
      {{ message }}
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">×</span>
      </button>
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}
  </div>
</div>

  <div class="col-md-4 offset-md-4">
    <div id ="formulario_abertura" class="card card-body">
      <form action="{{url_for('routes.add_student')}}" method="POST" enctype="multipart/form-data">

        <div class="form-group"> 
          <div id = 'abertura_titulo' class="row" style="width: 120px; display: flex; justify-content: center; align-items: center; margin-left: 80px;"><h3>Abrir OS</h3></div>       
            <label for="setor">Setor</label>
            <select class="form-control form-control" id="setor" name="setor" required>
              <option value="" selected disabled hidden></option>  
              <option>Administrativo</option>
              <option>Estamparia</option>
              <option>Solda</option>
              <option>Montagem</option>
              <option>Pintura</option>
              <option>Carpintaria</option>
              <option>Almoxarifado</option>
              <option>Usinagem</option>
              <option>Serra</option>
              <option>Corte</option>
              <option>Serralheria</option>
              <option>Manutenção</option>              
            </select>
        </div>

        <div class="form-group" id="maquina-select">
          <label for="maquina">Máquina:</label>
          <select style = 'width: 100%;' class="select2" name="maquina" >
            {% for maquina in lista_maquinas %}
            <option value="" selected disabled hidden></option>  
            <option value="{{maquina[0]}}">{{maquina[0]}}</option>
            {% endfor %}
          </select>
        </div>

        <div class="form-group" id="maquina-input">
          <label for="maquina">Área:</label>
          <!-- <input class="select2" name="maquina" > -->
          <select class="form-control form-control select2" id="maquina" name="setor" required>
            <option value="" selected disabled hidden></option>  
            <option>RH</option>
            <option>Vendas</option>
            <option>Contabilidade</option>
            <option>PCP</option>
            <option>Marketing</option>
            <option>TI</option>
            <option>Projetos</option>
            <option>Compras</option>              
          </select>
        </div>
         
        <div class="form-group">
          <label for="problema">Descrição:</label>
          <textarea id="problema" name="problema" rows="5" cols="39" required placeholder=" Descreva o problema..."></textarea>
        </div>

        <div class="form-group">        
          <label for="risco">Risco</label>
          <select class="form-control form-control" id="risco" name="risco" required>
              <option value="" selected disabled hidden></option>  
              <option>Alto</option>
              <option>Médio</option>
              <option>Baixo</option>
          </select>
        </div>

        <div class="form-group">        
          <label for="imagem">Imagem:</label>
          <input type="file" class="form-control-file" id="imagem" name="imagem">
        </div>

        <button id = 'salvar' class="btn btn-block">
          Save 
        </button>
        
      </form>
    </div>
  </div>
</div>


<!-- Script para desabilitar os campos de acordo com o setor-->
<script>
  document.getElementById('setor').addEventListener('change', function() {
    var setorValue = this.value;
    var maquinaSelect = document.getElementById('maquina-select');
    var maquinaInput = document.getElementById('maquina-input');
    
    if (setorValue === '') {
      maquinaSelect.style.display = 'none';
      maquinaInput.style.display = 'none';
    } else if (setorValue === 'Administrativo') {
      maquinaSelect.style.display = 'none';
      maquinaInput.style.display = '';
    } else {
      maquinaSelect.style.display = '';
      maquinaInput.style.display = 'none';
    }
  });
</script>


<!-- Script para gerar o dropdown com filtro por nome -->
<script>
  $(document).ready(function() {
    $('.select2').select2();
  });
</script>


{% endblock %}